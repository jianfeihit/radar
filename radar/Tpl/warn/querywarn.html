<div class="main">
	<div class="container">
		<div class="row">
			<div class="span12">
				<div class="widget stacked widget-table action-table">

					<div class="widget-header"> <i class="icon-th-list"></i>
						<h3>查询告警信息</h3>
					</div>
					<div class="widget-content">
						<form class="pagination10 form-inline text-center" action="__URL__/query">
							<div class="input-prepend">
								<div class="btn-group">
									<button class="btn dropdown-toggle" data-toggle="dropdown">
										查询类型
										<span class="caret"></span>
									</button>
									<ul class="dropdown-menu">
										<li>
											<a href="#">关键词</a>
										</li>
										<li>
											<a href="#">网站名称</a>
										</li>
									</ul>
								</div>
								<input class="input-xlarge" type="text"></div>
							<button type="submit" class="btn glow  btn-primary">查询</button>
						</form>

					</div>
				</div>
			</div>
			<div class="span12">
				<div class="widget stacked widget-table action-table">
					<div class="widget-content">
						<table class="table table-striped table-bordered  table-highlight">
							<thead>
								<tr>
									<th width="2%">
										<input type="checkbox" name="keywords[]" value="{$keyword.keyword}"></th>
									<th width="7%">网站名称</th>
									<th width="7%">关键词</th>
									<th width="15%">新闻标题</th>
									<th width="30%">新闻摘要</th>
									<th width="7%">检测时间</th>
									<th width="7%">处理标志</th>
									<th width="7%">简报标志</th>
									<th width="10%" class="td-actions">操作</th>
								</tr>
							</thead>
							<tbody>
								<volist name="kdata" id="v">
									<tr>
										<td>
											<input type="checkbox" name="keywords[]" value="{$keyword.keyword}"></td>
										<td>{$v.siteName}</td>
										<td>{$v.keyword}</td>
										<td>{$v.title}</td>
										<if condition="strlen('$v.digist') lt 50">
											<td>{$v.digist|msubstr=0,50,'utf-8',true}</td>
											<else />
											<td>{$v.digist}</td>
										</if>
										<td>{$v.checkDate}</td>
										<td><if condition="$v.isHandle eq 1"><span class="label label-success label-mini" id="label{$v.id}">已处理</span><else /><span class="label label-warning label-mini" id="label{$v.id}">未处理</span></if></td>
										<td>已生成</td>
										<td class="td-actions">
											<a href="javascript:;" class="btn btn-small btn-warning warn_sendmailbtn" warndata={$v.id}> <i class="btn-icon-only icon-envelope" title="发送通知"></i>
											</a>
											<a href="__URL__/view?id={$v.id}" class="btn btn-small btn-warning">
												<i class="btn-icon-only icon-zoom-in" title="查看详情"></i>
											</a>
											<a href="javascript:;" class="btn btn-small btn-warning">
												<i class="btn-icon-only icon-refresh" title="重新检测"></i>
											</a>
											<a href="{$v.link}" target="_blank" class="btn btn-small btn-warning">
												<i class="btn-icon-only icon-share-alt" title="查看链接"></i>
											</a>
										</td>
									</tr>
								</volist>
							</tbody>
						</table>
						<!-- {$page} -->
					</div>
					<div class="widget-content">
						<div class="text-left span5">
							<button type="submit" class="btn glow pagination btn-primary text-left">生成简报</button>
						</div>
						<div class="text-right span6">
							<div id="example"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script src="../Public/js/bootstrap-paginator.min.js"></script>
	<script type="text/javascript">
	$(document).ready(function(e) {
                $(".warn_sendmailbtn").click(function(e) {
			$.globalMessenger().post({
					message: '邮件发送中.',
					type: 'info',
					showCloseButton: false
					});
			var warndata = $(this).attr("warndata");
			$.ajax({url:"__URL__/mailnotify",type:"POST",data:{id:warndata},dataType:"json",success: function(resp){
				if(resp.success){
                                	$("#label"+warndata).addClass('label-success');
                                        $("#label"+warndata).removeClass('label-warning');
					 $("#label"+warndata).html("已处理");
					$.globalMessenger().post({
					message: '发送成功.',
					type: 'info',
					showCloseButton: true
					});
				}else{
					$.globalMessenger().post({
					message: resp.msg,
					type: 'info',
					showCloseButton: true
					});
				}
			}});
                });
        });
	var options = {
            currentPage: 4,
            totalPages: 10,
	    	numberOfPages:5
        }

	$('#example').bootstrapPaginator(options);
	$._messengerDefaults = {
	extraClasses: 'messenger-fixed messenger-theme-future messenger-on-bottom messenger-on-right'
	}
</script>